#!/usr/bin/env zsh

WITH_ZSH=true
WITH_VIM=true
WITH_TMUX=true
WITH_CLJ=true
WITH_GIT=true
WITH_SBCL=true
MINIMAL=''
while [ $# -gt 0 ]; do
    case "$1" in
        --no-zsh)
            WITH_ZSH=false
            ;;
        --no-vim)
            WITH_VIM=false
            ;;
        --no-tmux)
            WITH_TMUX=false
            ;;
        --no-clj)
            WITH_CLJ=false
            ;;
        --no-git)
            WITH_GIT=false
            ;;
        --no-sbcl)
            WITH_SBCL=false
            ;;
        --minimal)
            MINIMAL="--minimal"
            ;;
    esac
    shift
done

DOTFILES_DIR="$(dirname ${0:A})"

cat <<END > "$HOME/.zsh_dotfiles_init"
# Warning: This file is auto-generated by ${0:A}.
# It will be overwritten as soon as ${0:A} is run again.
export DOTFILES_DIR=$DOTFILES_DIR
export ZSH=${ZSH:="$HOME/.oh-my-zsh"}
END

$WITH_ZSH  && $DOTFILES_DIR/zsh/install.zsh $MINIMAL
$WITH_VIM && $DOTFILES_DIR/vim/install.zsh $MINIMAL
$WITH_TMUX && $DOTFILES_DIR/tmux/install.zsh $MINIMAL
$WITH_CLJ && $DOTFILES_DIR/leiningen/install.zsh $MINIMAL
$WITH_CLJ && $DOTFILES_DIR/clojure/install.zsh $MINIMAL
$WITH_GIT && $DOTFILES_DIR/git/install.zsh $MINIMAL
$WITH_SBCL && $DOTFILES_DIR/sbcl/install.zsh $MINIMAL
